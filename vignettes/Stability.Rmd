
### Stability analysis within group of samples

Calculate stability as the average correlation between samples and their
mean for a given phylotypes vs. samples matrix:

```{r bistability}
# Example data
library(microbiome)
data(peerj32)
x <- peerj32$microbes

# Quantify temporal stability across the abundance range
stability <- estimate_stability(t(x))$stability
```

### Stability analysis in time

Calculate correlations between time points 1 and 2 for each subject,
then calculate stability as the average correlation of these
subject-specific correlations. Done as above, but instead of one matrix,
give two matrices as input. These are phylotypes vs. samples matrices
and correspond to time points 1 and 2, respectively. The rows
(phylotypes) and columns (subjects) should be in the same order in both
matrices.


## Bimodality quantification

Calculate coefficients of bimodality (used in [Shade et
al.](http://mbio.asm.org/content/5/4/e01371-14)) for taxa in an
example data set, and plot the taxa with the lowest and highest score:

```{r bimodality, message=FALSE, warning=FALSE, fig.path = "figure/"}
# Load example data
library(microbiome)
data(peerj32); 
mydata <- t(peerj32$microbes)

# Calculate coefficient of bimodality for each taxa
bs <- apply(mydata, 1, coefficient.of.bimodality)

# Pick the most and least bimodal taxa as examples
unimodal <- names(which.min(bs))
bimodal <- names(which.max(bs))

# Visualize
par(mfrow = c(1,2))
plot(density(mydata[unimodal,]), main = unimodal)
plot(density(mydata[bimodal,]), main = bimodal)
```


### Version information

```{r stabilitysessioninfox}
sessionInfo()
```

