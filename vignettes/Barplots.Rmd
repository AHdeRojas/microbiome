### Coloured Barplots

The following example visualizes samples, colored by Phylum
percentages. For further examples, see [phyloseq
package](http://joey711.github.io/phyloseq/plot_bar-examples.html).

```{r barplot, warning=FALSE, message=FALSE, fig.width=8, fig.height=8, fig.path = "figure/"}
library(microbiome)
library(ggplot2)

# Microbiota profiling data. Read as: bacteria x samples matrix
# From https://peerj.com/articles/32/
x <- download_microbiome("peerj32")$physeq

# Visualize samples by Phyla (note: in HITChip data it is only approximately Phylum level)
plot_bar(x, x = "sample", fill = "Phylum")
```


[Phyloseq](http://joey711.github.io/phyloseq/plot_bar-examples.html) example, filling by Phylum:

```{r taxbar, fig.width=10, fig.height=7, warning=FALSE, message=FALSE}
p <- plot_bar(x, fill = "Phylum")
print(p)
```


Top OTU plot

```{r topotu, warning=FALSE, message=FALSE}
library(microbiome)
data.dietswap <- download_microbiome("dietswap")
TopNOTUs <- names(sort(taxa_sums(x), TRUE)[1:3])
tops <- prune_taxa(TopNOTUs, x)
plot_bar(tops, "group", fill = "gender", facet_grid = ~Phylum)
```


