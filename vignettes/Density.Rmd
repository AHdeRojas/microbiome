### Abundance histograms

Different sample sets have different population distributions in
microbial abundance. It is also important to consider whether to use
absolute or logarithmic abundances.


```{r hist, fig.width=16, fig.heigth=8, fig.path = "figure/"}
library(microbiome)
x <- download_microbiome("atlas1006")
# Pick the subset of RBB-preprocessed samples from time point 0
x <- subset_samples(x, time == 0 & DNA_extraction_method == "r")

# Visualize population densities for specific taxa
plot_density(x, "Bifidobacterium")

# Same with log10 abundances
plot_density(x, "Bifidobacterium", log10 = TRUE)

# Same with log10 relative abundances
x <- transform_sample_counts(x, function (x) {100 * x/sum(x)})
tax <- "Bifidobacterium"
plot_density(x, tax, log10 = TRUE) + ggtitle(paste(tax, "(Rel. Ab. %)"))
```

