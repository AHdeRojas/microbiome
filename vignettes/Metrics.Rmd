
### Correlation analysis

Cross-correlate input variables between two data sets (samples x features matrices; matched samples assumed; correlations calculated between features). For instance, between phylotypes and environmental variables:

```{r metrics-example22, warning=FALSE, message=FALSE}
# Read example data (x) and metadata (m)
library(microbiome)
data(peerj32)
x <- log10(peerj32$microbes)
m <- peerj32$meta

# Check sample size
N <- nrow(m)

# Calculate correlations between metadata and profiling data
cc <- cross.correlate(m, x,  mode = "table", p.adj.method = "BY")

print(head(cc))
```



Matrix mode plus visualization for the similarity matrix:  

```{r metrics-example3, fig.width=8, fig.height=8, warning=FALSE, message=FALSE}
cc <- cross.correlate(metadata.simulated, t(l2.log10.simulated), mode = "matrix")

tmp <- netresponse::plot_matrix(t(cc$cor), type = "twoway")
```
