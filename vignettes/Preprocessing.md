## Preprocessing taxonomic profiling data

Here we show how to manipulate microbiome data sets using tools from
the [phyloseq package](http://joey711.github.io/phyloseq/), including
subsetting, aggregating and filtering.


### Picking data from phyloseq  

Assuming your data ('pseq' below) is in the phyloseq format, many
standard tools are available.


Sample metadata:


```r
library(phyloseq)
meta <- sample_data(pseq)
```

Taxonomy table:


```r
tax.table <- tax_table(pseq)
```


Abundances for taxonomic groups:


```r
otu <- get_taxa(pseq)
```


Melted data for plotting:


```r
df <- psmelt(pseq)
kable(head(df))
```



|       |OTU                               |Sample     | Abundance| age|gender |nationality   |DNA_extraction_method |project | diversity|bmi_group   |subject | time|sample     |Phylum        |Genus                             |
|:------|:---------------------------------|:----------|---------:|---:|:------|:-------------|:---------------------|:-------|---------:|:-----------|:-------|----:|:----------|:-------------|:---------------------------------|
|113110 |Prevotella melaninogenica et rel. |Sample-448 |    944002|  54|female |CentralEurope |o                     |18      |      5.98|lean        |448     |    0|Sample-448 |Bacteroidetes |Prevotella melaninogenica et rel. |
|113015 |Prevotella melaninogenica et rel. |Sample-360 |    902034|  45|female |CentralEurope |o                     |13      |      5.49|severeobese |360     |    0|Sample-360 |Bacteroidetes |Prevotella melaninogenica et rel. |
|112747 |Prevotella melaninogenica et rel. |Sample-190 |    862870|  34|female |CentralEurope |r                     |7       |      6.06|lean        |190     |    0|Sample-190 |Bacteroidetes |Prevotella melaninogenica et rel. |
|113109 |Prevotella melaninogenica et rel. |Sample-743 |    852350|  52|male   |US            |NA                    |19      |      5.21|obese       |743     |    0|Sample-743 |Bacteroidetes |Prevotella melaninogenica et rel. |
|112944 |Prevotella melaninogenica et rel. |Sample-366 |    851147|  52|female |CentralEurope |o                     |15      |      5.63|obese       |366     |    0|Sample-366 |Bacteroidetes |Prevotella melaninogenica et rel. |
|113639 |Prevotella melaninogenica et rel. |Sample-375 |    844482|  45|female |CentralEurope |o                     |16      |      5.64|severeobese |375     |    0|Sample-375 |Bacteroidetes |Prevotella melaninogenica et rel. |


### Standard data processing operations

Let us look at [a two-week diet swap
study](http://dx.doi.org/10.1038/ncomms7342) between western (USA) and
traditional (rural Africa) diets including microbiota profiling:


```r
library(microbiome)
data("dietswap")
pseq <- dietswap
```

### Sample operations

Sample names and variables


```r
head(sample_names(pseq))
```

```
## [1] "Sample-1" "Sample-2" "Sample-3" "Sample-4" "Sample-5" "Sample-6"
```

Sample sums


```r
head(sample_sums(pseq))
```

```
## Sample-1 Sample-2 Sample-3 Sample-4 Sample-5 Sample-6 
##   533779  1330516  1822706   835998  1095023  1246234
```

Abundance of a given species in each sample


```r
head(get_sample(pseq, taxa_names(pseq)[1]))
```

```
## Sample-1 Sample-2 Sample-3 Sample-4 Sample-5 Sample-6 
##       11       67       21       42       16       20
```

Filter samples


```r
f1 <- filterfun_sample(topp(0.1))
taxa <- genefilter_sample(pseq, f1, A = round(0.5 * nsamples(pseq)))
```

Select samples by specific metadata fields:


```r
pseq.subset <- subset_samples(pseq, nationality == "AFR")
```


### Data transformations

The microbiome package provides a wrapper for standard sample/OTU transformations. For arbitrary transformations, use the transform_sample_counts function in the phyloseq package.

Log10 transformation (log(1+x) if the data contains zeroes)


```r
pseq.log <- transform_phyloseq(pseq, "log10")
```

Z transformation:


```r
# Z-transform OTUs
pseq.zotu <- transform_phyloseq(pseq, "Z", "OTU")
```

Relative abundances (the input data needs to be in absolute scale, not logarithmic!):


```r
pseq1 <- transform_phyloseq(pseq, "relative.abundance", "OTU")
pseq2 <- transform_sample_counts(pseq, function(x) x/sum(x))
```


### Variable operations

Sample variable names


```r
sample_variables(pseq)
```

```
## [1] "subject"                "sex"                   
## [3] "nationality"            "group"                 
## [5] "sample"                 "timepoint"             
## [7] "timepoint.within.group" "bmi_group"
```

Pick variable values for a given variable


```r
head(get_variable(pseq, sample_variables(pseq)[1]))
```

```
## [1] byn nms olt pku qjy riv
## 38 Levels: azh azl byn byu cxj dwc dwk eve fua fud gtd gty hsf irh ... zaq
```

```r
# Assign fields to sample metadata
# sample_data(GP)$human <- ..
```

### Taxa operations


Number of taxa


```r
n <- ntaxa(pseq)
```


Names


```r
ranks <- rank_names(pseq)
taxa <- taxa_names(pseq)
```


Prune taxa:


```r
taxa <- levelmap(NULL, "Phylum", "Genus", pseq)$Bacteroidetes
```

```
## Error in eval(expr, envir, enclos): could not find function "levelmap"
```

```r
# With given taxon names
ex2 <- prune_taxa(taxa, pseq)

# Taxa with positive sum across samples
ex3 <- prune_taxa(taxa_sums(pseq) > 0, pseq)
```


Subset taxa:


```r
pseq <- subset_taxa(pseq, Phylum == "Bacteroidetes")
```


Filter by user-specified function values (here variance):


```r
f <- filter_taxa(pseq, function(x) var(x) > 1e-05, TRUE)
```


List unique phylum-level groups: 


```r
head(get_taxa_unique(pseq, "Phylum"))
```

```
## [1] "Bacteroidetes"
```

Pick detected taxa by sample name:


```r
samplename <- sample_names(pseq)[[1]]
tax.abundances <- get_taxa(pseq, samplename)
```


Taxa sums


```r
head(taxa_sums(pseq))
```

```
##               Allistipes et rel.     Bacteroides fragilis et rel. 
##                          3513027                          2539567 
## Bacteroides intestinalis et rel.       Bacteroides ovatus et rel. 
##                           199684                          1516522 
##     Bacteroides plebeius et rel.  Bacteroides splachnicus et rel. 
##                           596972                           833871
```


### Merging operations

Aggregate taxa to higher taxonomic levels. This is particularly useful if the phylogenetic tree is missing. When it is available, see [merge_samples, merge_taxa and tax_glom](http://joey711.github.io/phyloseq/merge.html))


```r
pseq2 <- summarize_taxa(pseq, "Genus") 
```


Merging phyloseq objects


```r
merge_phyloseq(pseqA, pseqB)
```


### Rarification


```r
pseq.rarified <- rarefy_even_depth(pseq)
```


### Taxonomy 

Convert between taxonomic levels (here from Genus (Akkermansia) to
Phylum (Verrucomicrobia)):


```r
data("atlas1006")
m <- levelmap("Akkermansia", "Genus", "Phylum", tax_table(atlas1006))
```

```
## Error in eval(expr, envir, enclos): could not find function "levelmap"
```

```r
print(m)
```

```
## $mu
##            [,1]
## [1,] 4.94317121
## [2,] 0.01633968
## 
## $sd
##          [,1]
## [1,] 1.009435
## [2,] 1.005232
## 
## $w
## [1] 0.5002091 0.4997909
## 
## $free.energy
##          [,1]
## [1,] 868.0489
## 
## $Nparams
## [1] 6
## 
## $qofz
##                [,1]         [,2]
##   [1,] 9.982186e-08 9.999999e-01
##   [2,] 6.782839e-06 9.999932e-01
##   [3,] 2.443295e-05 9.999756e-01
##   [4,] 2.759557e-02 9.724044e-01
##   [5,] 2.053628e-07 9.999998e-01
##   [6,] 5.593356e-05 9.999441e-01
##   [7,] 4.957344e-03 9.950427e-01
##   [8,] 3.736972e-07 9.999996e-01
##   [9,] 3.025905e-06 9.999970e-01
##  [10,] 5.054839e-10 1.000000e+00
##  [11,] 1.752139e-05 9.999825e-01
##  [12,] 1.670139e-02 9.832986e-01
##  [13,] 6.866304e-04 9.993134e-01
##  [14,] 4.079170e-09 1.000000e+00
##  [15,] 1.951197e-04 9.998049e-01
##  [16,] 2.589920e-08 1.000000e+00
##  [17,] 3.668694e-07 9.999996e-01
##  [18,] 3.639006e-08 1.000000e+00
##  [19,] 9.378568e-05 9.999062e-01
##  [20,] 1.535339e-05 9.999846e-01
##  [21,] 7.510471e-04 9.992490e-01
##  [22,] 2.033111e-01 7.966889e-01
##  [23,] 1.761198e-08 1.000000e+00
##  [24,] 5.322524e-03 9.946775e-01
##  [25,] 2.548337e-06 9.999975e-01
##  [26,] 6.171187e-07 9.999994e-01
##  [27,] 2.122091e-10 1.000000e+00
##  [28,] 9.392656e-07 9.999991e-01
##  [29,] 1.717712e-10 1.000000e+00
##  [30,] 2.580269e-05 9.999742e-01
##  [31,] 1.968450e-04 9.998032e-01
##  [32,] 1.045943e-07 9.999999e-01
##  [33,] 2.779982e-06 9.999972e-01
##  [34,] 7.918533e-04 9.992081e-01
##  [35,] 2.202586e-02 9.779741e-01
##  [36,] 1.353039e-02 9.864696e-01
##  [37,] 7.576288e-08 9.999999e-01
##  [38,] 3.602051e-08 1.000000e+00
##  [39,] 6.633595e-07 9.999993e-01
##  [40,] 6.514244e-06 9.999935e-01
##  [41,] 7.346351e-09 1.000000e+00
##  [42,] 4.645182e-06 9.999954e-01
##  [43,] 1.248959e-05 9.999875e-01
##  [44,] 2.941348e-09 1.000000e+00
##  [45,] 2.444786e-09 1.000000e+00
##  [46,] 3.932893e-06 9.999961e-01
##  [47,] 2.416552e-07 9.999998e-01
##  [48,] 2.476629e-04 9.997523e-01
##  [49,] 2.880876e-01 7.119124e-01
##  [50,] 1.244700e-03 9.987553e-01
##  [51,] 3.384138e-09 1.000000e+00
##  [52,] 2.647745e-09 1.000000e+00
##  [53,] 6.664033e-03 9.933360e-01
##  [54,] 1.776447e-02 9.822355e-01
##  [55,] 3.962364e-07 9.999996e-01
##  [56,] 9.701194e-06 9.999903e-01
##  [57,] 7.845181e-05 9.999215e-01
##  [58,] 2.393499e-04 9.997607e-01
##  [59,] 6.909103e-03 9.930909e-01
##  [60,] 2.577274e-06 9.999974e-01
##  [61,] 4.676811e-05 9.999532e-01
##  [62,] 2.555622e-04 9.997444e-01
##  [63,] 3.378700e-06 9.999966e-01
##  [64,] 3.907276e-06 9.999961e-01
##  [65,] 1.560061e-03 9.984399e-01
##  [66,] 2.394848e-06 9.999976e-01
##  [67,] 6.930759e-05 9.999307e-01
##  [68,] 9.836626e-06 9.999902e-01
##  [69,] 1.455755e-03 9.985442e-01
##  [70,] 3.734836e-06 9.999963e-01
##  [71,] 1.397863e-03 9.986021e-01
##  [72,] 2.581307e-05 9.999742e-01
##  [73,] 6.433984e-08 9.999999e-01
##  [74,] 5.243743e-05 9.999476e-01
##  [75,] 3.602615e-06 9.999964e-01
##  [76,] 1.339641e-07 9.999999e-01
##  [77,] 1.109378e-07 9.999999e-01
##  [78,] 2.308547e-06 9.999977e-01
##  [79,] 4.320226e-04 9.995680e-01
##  [80,] 2.308823e-05 9.999769e-01
##  [81,] 3.117025e-07 9.999997e-01
##  [82,] 6.241674e-05 9.999376e-01
##  [83,] 7.840315e-05 9.999216e-01
##  [84,] 3.300177e-08 1.000000e+00
##  [85,] 3.412577e-05 9.999659e-01
##  [86,] 5.206912e-06 9.999948e-01
##  [87,] 4.656069e-07 9.999995e-01
##  [88,] 2.635821e-06 9.999974e-01
##  [89,] 2.511077e-05 9.999749e-01
##  [90,] 1.865848e-08 1.000000e+00
##  [91,] 3.064614e-03 9.969354e-01
##  [92,] 1.495863e-05 9.999850e-01
##  [93,] 3.985909e-05 9.999601e-01
##  [94,] 8.902215e-08 9.999999e-01
##  [95,] 1.647396e-08 1.000000e+00
##  [96,] 2.194394e-09 1.000000e+00
##  [97,] 8.263524e-06 9.999917e-01
##  [98,] 1.035422e-04 9.998965e-01
##  [99,] 1.908785e-09 1.000000e+00
## [100,] 1.391425e-06 9.999986e-01
## [101,] 8.531952e-06 9.999915e-01
## [102,] 2.624638e-06 9.999974e-01
## [103,] 1.307556e-04 9.998692e-01
## [104,] 4.146168e-09 1.000000e+00
## [105,] 1.398924e-08 1.000000e+00
## [106,] 6.338382e-05 9.999366e-01
## [107,] 7.384040e-06 9.999926e-01
## [108,] 9.808554e-01 1.914465e-02
## [109,] 1.233468e-03 9.987665e-01
## [110,] 1.110355e-05 9.999889e-01
## [111,] 3.565363e-04 9.996435e-01
## [112,] 1.298259e-06 9.999987e-01
## [113,] 4.457718e-05 9.999554e-01
## [114,] 1.468106e-05 9.999853e-01
## [115,] 2.125552e-03 9.978744e-01
## [116,] 7.367099e-06 9.999926e-01
## [117,] 1.954166e-07 9.999998e-01
## [118,] 6.060841e-08 9.999999e-01
## [119,] 1.832525e-12 1.000000e+00
## [120,] 2.980157e-01 7.019843e-01
## [121,] 4.624509e-08 1.000000e+00
## [122,] 2.413254e-06 9.999976e-01
## [123,] 4.752163e-06 9.999952e-01
## [124,] 2.127656e-02 9.787234e-01
## [125,] 4.549256e-07 9.999995e-01
## [126,] 5.521130e-04 9.994479e-01
## [127,] 1.165600e-04 9.998834e-01
## [128,] 4.389322e-05 9.999561e-01
## [129,] 1.189518e-03 9.988105e-01
## [130,] 6.932314e-04 9.993068e-01
## [131,] 1.323271e-07 9.999999e-01
## [132,] 1.418009e-04 9.998582e-01
## [133,] 1.665512e-10 1.000000e+00
## [134,] 9.432382e-04 9.990568e-01
## [135,] 9.629608e-08 9.999999e-01
## [136,] 7.838101e-06 9.999922e-01
## [137,] 2.632927e-06 9.999974e-01
## [138,] 1.762704e-05 9.999824e-01
## [139,] 3.210175e-07 9.999997e-01
## [140,] 9.442884e-03 9.905571e-01
## [141,] 3.707912e-07 9.999996e-01
## [142,] 1.278723e-06 9.999987e-01
## [143,] 1.904553e-05 9.999810e-01
## [144,] 6.871398e-10 1.000000e+00
## [145,] 9.445439e-06 9.999906e-01
## [146,] 5.358485e-05 9.999464e-01
## [147,] 2.683405e-07 9.999997e-01
## [148,] 1.453890e-04 9.998546e-01
## [149,] 8.422937e-06 9.999916e-01
## [150,] 1.066712e-08 1.000000e+00
## [151,] 6.302059e-06 9.999937e-01
## [152,] 2.161528e-07 9.999998e-01
## [153,] 4.145257e-04 9.995855e-01
## [154,] 8.947595e-07 9.999991e-01
## [155,] 2.839687e-05 9.999716e-01
## [156,] 3.389962e-06 9.999966e-01
## [157,] 6.662243e-07 9.999993e-01
## [158,] 6.856519e-07 9.999993e-01
## [159,] 4.870596e-06 9.999951e-01
## [160,] 1.865281e-04 9.998135e-01
## [161,] 6.401498e-03 9.935985e-01
## [162,] 7.245147e-04 9.992755e-01
## [163,] 9.399974e-07 9.999991e-01
## [164,] 3.229545e-04 9.996770e-01
## [165,] 9.046136e-08 9.999999e-01
## [166,] 2.935761e-06 9.999971e-01
## [167,] 8.218374e-08 9.999999e-01
## [168,] 4.468680e-09 1.000000e+00
## [169,] 2.265549e-05 9.999773e-01
## [170,] 1.270523e-05 9.999873e-01
## [171,] 2.090576e-04 9.997909e-01
## [172,] 2.378676e-01 7.621324e-01
## [173,] 3.956682e-03 9.960433e-01
## [174,] 6.074730e-06 9.999939e-01
## [175,] 3.774481e-04 9.996226e-01
## [176,] 3.617263e-04 9.996383e-01
## [177,] 5.229383e-05 9.999477e-01
## [178,] 2.107093e-06 9.999979e-01
## [179,] 2.723511e-06 9.999973e-01
## [180,] 1.408922e-05 9.999859e-01
## [181,] 8.198064e-06 9.999918e-01
## [182,] 2.125011e-05 9.999787e-01
## [183,] 1.210254e-04 9.998790e-01
## [184,] 2.249256e-03 9.977507e-01
## [185,] 7.233448e-07 9.999993e-01
## [186,] 6.235136e-08 9.999999e-01
## [187,] 2.258397e-09 1.000000e+00
## [188,] 2.154529e-03 9.978455e-01
## [189,] 1.643923e-07 9.999998e-01
## [190,] 3.011117e-06 9.999970e-01
## [191,] 1.949862e-04 9.998050e-01
## [192,] 5.537122e-04 9.994463e-01
## [193,] 1.672991e-02 9.832701e-01
## [194,] 9.087362e-03 9.909126e-01
## [195,] 1.623513e-07 9.999998e-01
## [196,] 2.514575e-06 9.999975e-01
## [197,] 4.810243e-02 9.518976e-01
## [198,] 1.859632e-05 9.999814e-01
## [199,] 9.952029e-08 9.999999e-01
## [200,] 2.346222e-07 9.999998e-01
## [201,] 9.999945e-01 5.541484e-06
## [202,] 9.999894e-01 1.060091e-05
## [203,] 9.998694e-01 1.305507e-04
## [204,] 9.999949e-01 5.097856e-06
## [205,] 9.999992e-01 7.625092e-07
## [206,] 1.000000e+00 5.046099e-11
## [207,] 9.958726e-01 4.127403e-03
## [208,] 9.999999e-01 8.877454e-08
## [209,] 9.999999e-01 6.501521e-08
## [210,] 9.999902e-01 9.807563e-06
## [211,] 1.000000e+00 2.091777e-11
## [212,] 9.992118e-01 7.881512e-04
## [213,] 9.999884e-01 1.159953e-05
## [214,] 9.108520e-01 8.914799e-02
## [215,] 5.315992e-01 4.684008e-01
## [216,] 1.000000e+00 6.861840e-09
## [217,] 9.999951e-01 4.856104e-06
## [218,] 9.997872e-01 2.128388e-04
## [219,] 9.999993e-01 6.664800e-07
## [220,] 9.999994e-01 5.953013e-07
## [221,] 1.000000e+00 6.117574e-09
## [222,] 9.999829e-01 1.714158e-05
## [223,] 9.999984e-01 1.565799e-06
## [224,] 1.000000e+00 3.235906e-11
## [225,] 1.000000e+00 3.756162e-08
## [226,] 1.000000e+00 2.852833e-09
## [227,] 9.999893e-01 1.074241e-05
## [228,] 9.999992e-01 7.728016e-07
## [229,] 9.999985e-01 1.538755e-06
## [230,] 9.996764e-01 3.236308e-04
## [231,] 9.996930e-01 3.069970e-04
## [232,] 9.993305e-01 6.694614e-04
## [233,] 9.990877e-01 9.122924e-04
## [234,] 9.999951e-01 4.911351e-06
## [235,] 9.999998e-01 1.574288e-07
## [236,] 9.999998e-01 2.145708e-07
## [237,] 1.000000e+00 3.800532e-08
## [238,] 9.927696e-01 7.230412e-03
## [239,] 4.354470e-01 5.645530e-01
## [240,] 9.999979e-01 2.105538e-06
## [241,] 9.999995e-01 5.437019e-07
## [242,] 9.999981e-01 1.868790e-06
## [243,] 1.000000e+00 4.348630e-09
## [244,] 1.000000e+00 9.621717e-09
## [245,] 9.999835e-01 1.647211e-05
## [246,] 9.999998e-01 2.478086e-07
## [247,] 1.000000e+00 3.979891e-10
## [248,] 9.999986e-01 1.381578e-06
## [249,] 9.999686e-01 3.136112e-05
## [250,] 9.884744e-01 1.152565e-02
## [251,] 9.999537e-01 4.633415e-05
## [252,] 9.846588e-01 1.534123e-02
## [253,] 9.997600e-01 2.400266e-04
## [254,] 9.999995e-01 4.695145e-07
## [255,] 1.000000e+00 1.525200e-08
## [256,] 9.999348e-01 6.521558e-05
## [257,] 9.999754e-01 2.460474e-05
## [258,] 9.999948e-01 5.190370e-06
## [259,] 7.854623e-01 2.145377e-01
## [260,] 9.999996e-01 3.830291e-07
## [261,] 9.999983e-01 1.740215e-06
## [262,] 9.998914e-01 1.085733e-04
## [263,] 9.999964e-01 3.627882e-06
## [264,] 9.883606e-01 1.163940e-02
## [265,] 9.999920e-01 7.997904e-06
## [266,] 9.281099e-01 7.189007e-02
## [267,] 9.999992e-01 7.828358e-07
## [268,] 9.999870e-01 1.300452e-05
## [269,] 1.000000e+00 1.936978e-09
## [270,] 9.998928e-01 1.072045e-04
## [271,] 9.997616e-01 2.383601e-04
## [272,] 9.963188e-01 3.681222e-03
## [273,] 9.999976e-01 2.428712e-06
## [274,] 1.000000e+00 1.121408e-08
## [275,] 9.999974e-01 2.576888e-06
## [276,] 9.999987e-01 1.323250e-06
## [277,] 9.998561e-01 1.438807e-04
## [278,] 9.999989e-01 1.098714e-06
## [279,] 9.994176e-01 5.824246e-04
## [280,] 9.996915e-01 3.084608e-04
## [281,] 9.092133e-01 9.078673e-02
## [282,] 9.999963e-01 3.734895e-06
## [283,] 9.999376e-01 6.244233e-05
## [284,] 9.999225e-01 7.745517e-05
## [285,] 9.999770e-01 2.297999e-05
## [286,] 9.999969e-01 3.139617e-06
## [287,] 9.100293e-01 8.997068e-02
## [288,] 9.999927e-01 7.282238e-06
## [289,] 9.997370e-01 2.629724e-04
## [290,] 9.999958e-01 4.216806e-06
## [291,] 1.000000e+00 6.926656e-09
## [292,] 1.000000e+00 4.098983e-08
## [293,] 9.941653e-01 5.834747e-03
## [294,] 9.999998e-01 2.224687e-07
## [295,] 9.999269e-01 7.309976e-05
## [296,] 9.995650e-01 4.350099e-04
## [297,] 9.986772e-01 1.322787e-03
## [298,] 1.000000e+00 2.718552e-09
## [299,] 9.999980e-01 1.964016e-06
## [300,] 9.916280e-01 8.372047e-03
## [301,] 9.998623e-01 1.376960e-04
## [302,] 9.999878e-01 1.224095e-05
## [303,] 9.999150e-01 8.504649e-05
## [304,] 1.000000e+00 1.019737e-09
## [305,] 1.000000e+00 1.316590e-08
## [306,] 1.000000e+00 1.021854e-08
## [307,] 1.000000e+00 3.377923e-10
## [308,] 9.999819e-01 1.810198e-05
## [309,] 9.996064e-01 3.936254e-04
## [310,] 1.000000e+00 5.898093e-10
## [311,] 9.999992e-01 8.494352e-07
## [312,] 9.999821e-01 1.794333e-05
## [313,] 9.964939e-01 3.506052e-03
## [314,] 1.000000e+00 1.211065e-09
## [315,] 9.999877e-01 1.234326e-05
## [316,] 9.999704e-01 2.959258e-05
## [317,] 9.999995e-01 4.653676e-07
## [318,] 9.999997e-01 3.362498e-07
## [319,] 9.991890e-01 8.110386e-04
## [320,] 9.999980e-01 2.031687e-06
## [321,] 9.999986e-01 1.444797e-06
## [322,] 9.999672e-01 3.284209e-05
## [323,] 1.000000e+00 1.191722e-08
## [324,] 9.999681e-01 3.189225e-05
## [325,] 8.782464e-01 1.217536e-01
## [326,] 9.999977e-01 2.344714e-06
## [327,] 9.997712e-01 2.288364e-04
## [328,] 9.999082e-01 9.184805e-05
## [329,] 9.999827e-01 1.731524e-05
## [330,] 9.999947e-01 5.269473e-06
## [331,] 9.999457e-01 5.425002e-05
## [332,] 9.999999e-01 1.288754e-07
## [333,] 9.999477e-01 5.234219e-05
## [334,] 9.566117e-01 4.338825e-02
## [335,] 1.000000e+00 3.342845e-08
## [336,] 7.746303e-01 2.253697e-01
## [337,] 9.999995e-01 4.532124e-07
## [338,] 9.999968e-01 3.221958e-06
## [339,] 9.980842e-01 1.915817e-03
## [340,] 9.997701e-01 2.299494e-04
## [341,] 9.999876e-01 1.244146e-05
## [342,] 9.998921e-01 1.078796e-04
## [343,] 1.000000e+00 1.845307e-09
## [344,] 9.999688e-01 3.115613e-05
## [345,] 9.997398e-01 2.601735e-04
## [346,] 9.998878e-01 1.122323e-04
## [347,] 9.999985e-01 1.489636e-06
## [348,] 9.999997e-01 3.077339e-07
## [349,] 9.999808e-01 1.922389e-05
## [350,] 9.995307e-01 4.693008e-04
## [351,] 9.999994e-01 5.799540e-07
## [352,] 9.960159e-01 3.984099e-03
## [353,] 9.999833e-01 1.665502e-05
## [354,] 9.999334e-01 6.659692e-05
## [355,] 9.853998e-01 1.460024e-02
## [356,] 9.999985e-01 1.465076e-06
## [357,] 9.999992e-01 7.971926e-07
## [358,] 9.999968e-01 3.160648e-06
## [359,] 9.999018e-01 9.815207e-05
## [360,] 9.999998e-01 1.622821e-07
## [361,] 9.999988e-01 1.165902e-06
## [362,] 9.999998e-01 1.977957e-07
## [363,] 9.999997e-01 3.289742e-07
## [364,] 9.999994e-01 5.747439e-07
## [365,] 9.999291e-01 7.090723e-05
## [366,] 9.999976e-01 2.433222e-06
## [367,] 9.999949e-01 5.145573e-06
## [368,] 9.996222e-01 3.778018e-04
## [369,] 9.985297e-01 1.470339e-03
## [370,] 9.314454e-01 6.855457e-02
## [371,] 9.999952e-01 4.818542e-06
## [372,] 9.999321e-01 6.791843e-05
## [373,] 9.999957e-01 4.315472e-06
## [374,] 9.999999e-01 1.089378e-07
## [375,] 9.999998e-01 1.901153e-07
## [376,] 9.999976e-01 2.375590e-06
## [377,] 9.999979e-01 2.062988e-06
## [378,] 1.000000e+00 2.013383e-08
## [379,] 9.999789e-01 2.106513e-05
## [380,] 9.999987e-01 1.310348e-06
## [381,] 9.630194e-01 3.698060e-02
## [382,] 1.000000e+00 1.230290e-08
## [383,] 9.999330e-01 6.696369e-05
## [384,] 9.999997e-01 3.124649e-07
## [385,] 9.999987e-01 1.301683e-06
## [386,] 1.000000e+00 4.787048e-09
## [387,] 9.999978e-01 2.154371e-06
## [388,] 1.000000e+00 2.654724e-11
## [389,] 1.000000e+00 2.147316e-09
## [390,] 1.000000e+00 4.512048e-09
## [391,] 9.999951e-01 4.858817e-06
## [392,] 9.999928e-01 7.224643e-06
## [393,] 9.999983e-01 1.704331e-06
## [394,] 1.000000e+00 2.740674e-08
## [395,] 9.999956e-01 4.351770e-06
## [396,] 9.999535e-01 4.649917e-05
## [397,] 9.998763e-01 1.237181e-04
## [398,] 9.999882e-01 1.182125e-05
## [399,] 9.999980e-01 1.998428e-06
## [400,] 9.999955e-01 4.515013e-06
```


### Metadata

Visualize frequencies of given factor (sex) levels within the
indicated groups (group):


```r
data(dietswap)
res <- plot_frequencies(sample_data(dietswap), "group", "sex")
print(res$plot)
```

![plot of chunk phylogeny-example3](figure/phylogeny-example3-1.png)

```r
kable(res$data, digits = 2)
```



|Groups |Factor |  n|   pct|
|:------|:------|--:|-----:|
|DI     |Female | 34| 47.22|
|DI     |Male   | 38| 52.78|
|ED     |Female | 34| 45.33|
|ED     |Male   | 41| 54.67|
|HE     |Female | 34| 45.33|
|HE     |Male   | 41| 54.67|

